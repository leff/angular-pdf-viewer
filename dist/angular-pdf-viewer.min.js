function delegateService(e){return["$log",function(t){function n(e){this.handle=e}var r=this,a=this._instances=[];this._registerInstance=function(e,t){return e.$$delegateHandle=t,a.push(e),function(){var t=a.indexOf(e);-1!==t&&a.splice(t,1)}},this.$getByHandle=function(e){return e?new n(e):r},e.forEach(function(e){n.prototype[e]=function(){var n,r,o=this.handle,i=arguments,l=0;return a.forEach(function(t){t.$$delegateHandle===o&&(l++,r=t[e].apply(t,i),1===l&&(n=r))}),l?n:t.warn('Delegate for handle "'+this.handle+'" could not find a corresponding element with delegate-handle="'+this.handle+'"! '+e+"() was not called!\nPossible cause: If you are calling "+e+'() immediately, and your element with delegate-handle="'+this.handle+'" is a child of your controller, then your element may not be compiled yet. Put a $timeout around your call to '+e+"() and try again.")},r[e]=function(){var t,n,r=arguments;return a.forEach(function(a,o){n=a[e].apply(a,r),0===o&&(t=n)}),t}})}]}angular.module("pdf",[]).service("pdfDelegate",delegateService(["prev","next","zoomIn","zoomOut","zoomTo","rotate","getPageCount","getCurrentPage","goToPage","getScale","load","setPDFDoc","renderPage"])),angular.module("pdf").service("pdfEventService",["$rootScope",function(e){this.broadcast=function(t,n){e.$broadcast("pdf:"+t,n)},this.listen=function(t,n){e.$on("pdf:"+t,n)}}]).controller("PdfCtrl",["$scope","$element","$attrs","pdfDelegate","$log","pdfEventService","$q",function(e,t,n,r,a,o,i){var l=r._registerInstance(this,n.delegateHandle);e.$on("$destroy",l);var u,c=this,d=e.$eval(n.url),s=e.$eval(n.headers);e.pageCount=0;var g=1,f=0,p=n.scale?n.scale:1,h=t.find("canvas"),v=h[0],m=v.getContext("2d");c.renderPage=function(e){var t=i.defer();return angular.isNumber(e)||(e=parseInt(e)),g=e,o.broadcast("renderStart"),u.getPage(e).then(function(e){var n=e.getViewport(p);v.height=n.height,v.width=n.width;var r={canvasContext:m,viewport:n},a=e.render(r);a.promise.then(function(){o.broadcast("renderComplete"),t.resolve("renderComplete")})}),t.promise};var y=function(){v.style.webkitTransform="rotate("+f+"deg)",v.style.MozTransform="rotate("+f+"deg)",v.style.msTransform="rotate("+f+"deg)",v.style.OTransform="rotate("+f+"deg)",v.style.transform="rotate("+f+"deg)"},P=function(e){e&&e.scale&&(p=parseFloat(e.scale))};c.prev=function(e){var t=i.defer();return 1>=g?t.reject("At first page"):(P(e),g=parseInt(g,10)-1,c.renderPage(g).then(function(){t.resolve(g)}),o.broadcast("pageChanged",g)),t.promise},c.next=function(e){var t=i.defer();return g>=u.numPages?t.reject("No more pages"):(P(e),g=parseInt(g,10)+1,c.renderPage(g).then(function(){t.resolve(g)}),o.broadcast("pageChanged",g)),t.promise},c.zoomIn=function(e){var t=i.defer();return e=e||.2,p=parseFloat(p)+e,c.renderPage(g).then(function(){t.resolve(p)}),t.promise},c.zoomOut=function(e){var t=i.defer();return e=e||.2,p=parseFloat(p)-e,p=p>0?p:.1,c.renderPage(g).then(function(){t.resolve(p)}),t.promise},c.zoomTo=function(e){var t=i.defer();return e=e?e:1,p=parseFloat(e),c.renderPage(g).then(function(){t.resolve(p)}),t.promise},c.rotate=function(){var e=i.defer();return f=0===f?90:90===f?180:180===f?270:0,y(),e.resolve(f),e.promise},c.getPageCount=function(){return e.pageCount},c.getCurrentPage=function(){return g},c.getScale=function(){var e=v.height,t=v.width,n=p;return{height:e,width:t,scale:n}},c.goToPage=function(e,t){if(null!==u){var n=i.defer();return P(t),g=e,c.renderPage(e).then(function(){n.resolve(g)}),n.promise}},c.setPDFDoc=function(e){u=e},c.load=function(t){t&&(d=t);var n={},r=i.defer();return s?(n.url=d,n.httpHeaders=s):n.url=d,PDFJS.getDocument(n).then(function(t){r.resolve(t),e.$apply(function(){e.pageCount=t.numPages})},a.error),r.promise}}]),angular.module("pdf").directive("pdfViewerToolbar",["pdfDelegate",function(e){return{restrict:"E",template:'<div class="clearfix mb2 white bg-blue"><div class="left"><a href=""ng-click="prev()"class="button py2 m0 button-nav-dark">Back</a><a href=""ng-click="next()"class="button py2 m0 button-nav-dark">Next</a><a href=""ng-click="zoomIn()"class="button py2 m0 button-nav-dark">Zoom In</a><a href=""ng-click="zoomOut()"class="button py2 m0 button-nav-dark">Zoom Out</a><a href=""ng-click="rotate()"class="button py2 m0 button-nav-dark">Rotate</a><span class="px1">Page</span> <input type="text" class="field-dark" min=1 ng-model="currentPage" ng-change="goToPage()" style="width: 10%">  / {{pageCount}}</div></div>',scope:{pageCount:"="},link:function(t,n,r){var a=r.delegateHandle;t.currentPage=1,t.prev=function(){e.$getByHandle(a).prev(),o()},t.next=function(){e.$getByHandle(a).next(),o()},t.zoomIn=function(){e.$getByHandle(a).zoomIn()},t.zoomOut=function(){e.$getByHandle(a).zoomOut()},t.rotate=function(){e.$getByHandle(a).rotate()},t.goToPage=function(){e.$getByHandle(a).goToPage(t.currentPage)};var o=function(){t.currentPage=e.$getByHandle(a).getCurrentPage()}}}}]),angular.module("pdf").directive("pdfViewer",["$window","$log","pdfDelegate",function(){return{restrict:"E",template:'<pdf-viewer-toolbar ng-if="showToolbar" delegate-handle="{{id}}" page-count="pageCount"></pdf-viewer-toolbar><canvas></canvas>',scope:!0,controller:"PdfCtrl",link:function(e,t,n){e.id=n.delegateHandle,e.showToolbar=e.$eval(n.showToolbar)||!1}}}]);